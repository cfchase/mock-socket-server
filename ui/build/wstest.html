<!doctype html>

<html>
  <head>
    <title>Device Motion and Orientation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>

  <body>
    <h1>test ws</h1>

  </body>
  <!--<script src="assets/js/nes/dist/client.js"></script>-->
  <!--<script>-->
    <!--const Nes = window.nes;-->
    <!--let client = new Nes.Client('ws://0.0.0.0:8080');-->

    <!--const start = async () => {-->

      <!--await client.connect();-->
      <!--const payload = await client.request('hello');  // Can also request '/h'-->
      <!--// payload -> 'world!'-->
      <!--console.log(payload);-->
    <!--};-->

    <!--start();-->
  <!--</script>-->

    <script>
      // Create WebSocket connection.
      const socket = new WebSocket('ws://localhost:8080');
      const sessionId = new Date().getTime();

      const hello = {
        type: 'hello',
        id: sessionId,
        version: '2'
      };

      // Connection opened
      socket.addEventListener('open', function (event) {
        //init with hello
        socket.send(JSON.stringify(hello));
        setInterval(sendMessage, 5000);
      });

      // Listen for messages
      socket.addEventListener('message', function (event) {
        console.log('Message from server: ', event.data);
      });

      function sendMessage() {
        const msg = {
          type: 'request',
          id: sessionId,
          method: 'POST',
          path: '/api/motions',
          payload: {
            id: new Date().getTime(),
            sessionId,
            data: {
              hello: "world-" + new Date().getTime()
            }
          }
        };

        socket.send(JSON.stringify(msg));
      }
    </script>
</html>
