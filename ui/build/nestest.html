<!doctype html>

<html>
<head>
    <title>Device Motion and Orientation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
<h1>test nes client</h1>
<ol id="messages">
</ol>
</body>
<script src="assets/js/nes/dist/client.js"></script>
<script>
  const Nes = window.nes;
  let uri = "ws:" + "//" + window.location.host + window.location.pathname;
  let client = new Nes.Client(uri);

  const start = async () => {

    await client.connect();
    setInterval(async () => {
        const messages = document.getElementById('messages');
        let payload = await client.request('/api/status');
        console.log(payload);
        console.log(JSON.stringify(payload));
        let newMessage = document.createElement('li');
        console.log(newMessage);
        newMessage.appendChild(document.createTextNode(JSON.stringify(payload)));
        messages.appendChild(newMessage);
      },
      5000
    );
  };

  start();
</script>
</html>
